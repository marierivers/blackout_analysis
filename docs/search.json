[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Blackout Analysis",
    "section": "",
    "text": "This analysis evaluates the spatial distribution of power outages in Houston, Texas caused by severe winter storms in February 2021 and explores which geographic/socioeconomic variables are most correlated with power outages."
  },
  {
    "objectID": "index.html#read-in-satellite-imagery",
    "href": "index.html#read-in-satellite-imagery",
    "title": "Blackout Analysis",
    "section": "Read in satellite imagery",
    "text": "Read in satellite imagery\nThe function below takes an HDFEOS file as input and, from that file, reads the DNB_at_Sensor_Radiance_500m dataset into a using the `stars’ package. The function then reads the sinusoidal tile x/y positions, adjusts the dimensions, and sets the coordinate reference system.\n\n# function to read and process imagery files as rasters using the stars package\nread_dnb_file <- function(file_name) {\n  \n  # HDF dataset that contains the night lights band\n  dataset_name <- \"//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m\"\n  \n  # extract the horizontal and vertical tile coordinates from the metadata\n  # this information is a string of text\n  h_string <- gdal_metadata(file_name)[199]\n  v_string <- gdal_metadata(file_name)[219]\n  \n  # from the horizontal and vertical tile text, obtain the coordinate info as an integer\n  tile_h <- as.integer(str_split(h_string, \"=\", simplify = TRUE)[[2]])\n  tile_v <- as.integer(str_split(v_string, \"=\", simplify = TRUE)[[2]])\n  \n  # use tile coordinates to calculate a geographic bounding box\n  west <- (10 * tile_h) - 180\n  north <- 90 - (10 * tile_v)\n  east <- west + 10\n  south <- north - 10\n  \n  delta <- 10 / 2400\n  \n  # read the dataset\n  dnb <- read_stars(file_name, sub = dataset_name)\n  \n  # set the coordinate reference system\n  st_crs(dnb) <- st_crs(4326)\n  st_dimensions(dnb)$x$delta <- delta\n  st_dimensions(dnb)$x$offset <- west\n  st_dimensions(dnb)$y$delta <- -delta\n  st_dimensions(dnb)$y$offset <- north\n  \n  return(dnb)\n}\n\nxxx…notes on what this function is doing…\nxxx…maybe instead of including the output of the above chunks, hard code them into text\nxxx…write a function to read all .h5 files and run this function…might not work because this isn’t an rbind thing…maybe could specify an output object name that is based on the input file name\n\n# load in files using the read_dnb function\nfeb7_h08v05_file_name <- \"data/VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.h5\"\ndnb_feb7_h08v05 <- read_dnb_file(file_name = feb7_h08v05_file_name)\n\nfeb7_h08v06_file_name <- \"data/VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.h5\"\ndnb_feb7_h08v06  <- read_dnb_file(file_name = feb7_h08v06_file_name)\n\nfeb16_h08v05_file_name <- \"data/VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.h5\"\ndnb_feb16_h08v05 <- read_dnb_file(file_name = feb16_h08v05_file_name)\n\nfeb16_h08v06_file_name <- \"data/VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.h5\"\ndnb_feb16_h08v06 <- read_dnb_file(file_name = feb16_h08v06_file_name)\n\nCombine the data using st_mosaic()\n\n# combined imagery before the storms\ndnb_feb7 <-  st_mosaic(dnb_feb7_h08v05, dnb_feb7_h08v06)\n\n# combined imagery after the storms\ndnb_feb16 <- st_mosaic(dnb_feb16_h08v05, dnb_feb16_h08v06)\n\n\n# convert fill value of 65535 to NA\ndnb_feb7[dnb_feb7 == 65535] = NA\ndnb_feb16[dnb_feb16 == 65535] = NA\n\n\n\n\n\n\n\nNote\n\n\n\nAt this point you may want to save memory by removing objects that wont be used in the rest of the analysis. Unfold the code below to see how to do this.\n\n\nCode\n#remove data not needed anymore\nrm(dnb_feb7_h08v05, dnb_feb7_h08v06, dnb_feb16_h08v05, dnb_feb16_h08v06)\ngc()\n\n\n\n\nThe code below defines a bounding box for the region of interest.\n\n# set region on interest\nroi <- st_polygon(list(rbind(c(-96.5,29), c(-96.5,30.5), c(-94.5,30.5), c(-94.5,29), c(-96.5,29))))\n\n# set coordinate reference system\nroi_sfc <- st_sfc(roi, crs = 4326)\n\nCrop the data to the region of interest ::: {.cell}\ndnb_feb7_crop <- st_crop(dnb_feb7, roi_sfc)\ndnb_feb16_crop <- st_crop(dnb_feb16, roi_sfc)\n:::"
  },
  {
    "objectID": "index.html#visualize-the-data",
    "href": "index.html#visualize-the-data",
    "title": "Blackout Analysis",
    "section": "Visualize the data",
    "text": "Visualize the data\n\n\nBefore the storms\n\n\n\n\n\n\nAfter the storms"
  },
  {
    "objectID": "index.html#create-blackout-mask",
    "href": "index.html#create-blackout-mask",
    "title": "Blackout Analysis",
    "section": "Create blackout mask",
    "text": "Create blackout mask\nA xxx…[raster] representing the difference in night light intensity is created by subtracting the post-storm imagery from the pre-storm imagery Next, a blackout mask is created to identify areas where night light intensity decreased by more than 200 nW cm-2 sr-1. For this analysis, differences in night light intensity is assumed to be caused by the storms.\n\nnight_light_difference <- dnb_feb7 - dnb_feb16\n\nblackout_mask <- night_light_difference\nblackout_mask[blackout_mask <= 200] = NA\nblackout_mask[blackout_mask > 200] = TRUE\n\n# vectorize the blackout mask\nblackout_mask_sf <- st_as_sf(blackout_mask)\nblackout_mask_sf_valid <- st_make_valid(blackout_mask_sf)\n\nNext, the blackout mask is cropped to the region of interest and transformed to the correct projections. ::: {.cell}\nblackout_mask_roi <- blackout_mask_sf_valid[roi_sfc, op = st_intersects]\n\n# transform blackout roi to Texas centric albers equal area\nblackout_mask_roi_3083 <- st_transform(blackout_mask_roi, crs = 3083)\n:::"
  },
  {
    "objectID": "index.html#road-data",
    "href": "index.html#road-data",
    "title": "Blackout Analysis",
    "section": "Road data",
    "text": "Road data\nRoadway data was obtained from xxx. Since vehicles can be a significant source of observable nighttime light, a 200 meter highway buffer was removed from the blackout mask area to prevent areas that experienced reduced traffic from being identified as areas with power outages.\n\n# load in roads package and select specifically highways\nquery <- \"SELECT * FROM gis_osm_roads_free_1 WHERE fclass in ('motorway', 'motorway_link', 'primary', 'primary_link')\"\nhighways <- st_read(\"data/gis_osm_roads_free_1.gpkg\", query = query)\n\n# transform to the correct projection\nhighways_3083 <- st_transform(highways, crs = 3083)\n\n# create a 200 meter buffer\nhighways_buffer_3083 <- st_buffer(highways_3083, dist = 200) \nhighways_buffer_3083 <- st_union(highways_buffer_3083)\n\n\n# remove the highway buffer from our vectorized blackout mask using st_difference()\nblackout_no_highway_3083 <- st_difference(blackout_mask_roi_3083, highways_buffer_3083)\n\n\n\nCode\n# transform to WG84 to be compatible with the leaflet package\nblackout_no_highway_4326 <- st_transform(blackout_no_highway_3083, crs = 4326)\n\nleaflet(blackout_no_highway_4326) %>%\n  setView(lat = 29.75, lng = -95.5, zoom = 9) %>%\n  addProviderTiles(providers$OpenStreetMap) %>%\n  addPolygons(color = \"green\")"
  },
  {
    "objectID": "index.html#building-data",
    "href": "index.html#building-data",
    "title": "Blackout Analysis",
    "section": "Building data",
    "text": "Building data\nThe building data has previously been cropped to Houston metroplitan area. ::: {.cell .column-page-right}\n#read in buildings data and select only residential\nquery_buildings <- \"SELECT *\nFROM gis_osm_buildings_a_free_1\nWHERE (type IS NULL AND name IS NULL)\nOR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')\"\n\n# read buildings gpkg into object, and transform to correct projection\nbuildings <- st_read(\"data/gis_osm_buildings_a_free_1.gpkg\", query = query_buildings)\nbuildings_3083 <- st_transform(buildings, crs = 3083)\nbuildings_4326 <- st_transform(buildings, crs = 4326)\n:::"
  },
  {
    "objectID": "index.html#census-data",
    "href": "index.html#census-data",
    "title": "Blackout Analysis",
    "section": "Census data",
    "text": "Census data\nSocioeconomic data was obtained from the U.S. Census Bureau’s American Community Survey (ACS)\nxxx…note the year of the data and update if needed\n\n\n\n\n\n\nNote\n\n\n\nThe ACS data consists of the layers listed below, with each layer containing subsets of data as documented in the ACS Metadata.\n\n\n\nAmerican Commnity Surey Layer Names\n\n  \n    \n\n\n \n  \n    Layer name \n  \n \n\n  \n    X01_AGE_AND_SEX \n  \n  \n    X02_RACE \n  \n  \n    X03_HISPANIC_OR_LATINO_ORIGIN \n  \n  \n    X04_ANCESTRY \n  \n  \n    X05_FOREIGN_BORN_CITIZENSHIP \n  \n  \n    X06_PLACE_OF_BIRTH \n  \n  \n    X07_MIGRATION \n  \n  \n    X08_COMMUTING \n  \n  \n    X09_CHILDREN_HOUSEHOLD_RELATIONSHIP \n  \n  \n    X10_GRANDPARENTS_GRANDCHILDREN \n  \n  \n    X11_HOUSEHOLD_FAMILY_SUBFAMILIES \n  \n  \n    X12_MARITAL_STATUS_AND_HISTORY \n  \n  \n    X13_FERTILITY \n  \n  \n    X14_SCHOOL_ENROLLMENT \n  \n  \n    X15_EDUCATIONAL_ATTAINMENT \n  \n  \n    X16_LANGUAGE_SPOKEN_AT_HOME \n  \n\n\n\n \n    \n\n\n \n  \n    Layer name \n  \n \n\n  \n    X17_POVERTY \n  \n  \n    X18_DISABILITY \n  \n  \n    X19_INCOME \n  \n  \n    X20_EARNINGS \n  \n  \n    X21_VETERAN_STATUS \n  \n  \n    X22_FOOD_STAMPS \n  \n  \n    X23_EMPLOYMENT_STATUS \n  \n  \n    X25_HOUSING_CHARACTERISTICS \n  \n  \n    X27_HEALTH_INSURANCE \n  \n  \n    X28_COMPUTER_AND_INTERNET_USE \n  \n  \n    X29_VOTING_AGE_POPULATION \n  \n  \n    X99_IMPUTATION \n  \n  \n    X24_INDUSTRY_OCCUPATION \n  \n  \n    X26_GROUP_QUARTERS \n  \n  \n    TRACT_METADATA_2019 \n  \n  \n    ACS_2019_5YR_TRACT_48_TEXAS \n  \n\n\n\n \n  \n\n\n\n\n\n\n\nGeometry of each cencus tract ::: {.cell .column-page-right}\n# read in census data geometry\nacs_geoms <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                     layer = \"ACS_2019_5YR_TRACT_48_TEXAS\") %>%\n  select(-(STATEFP:Shape_Area))\n:::\nAge and Sex Layer ::: {.cell .column-page-right}\n# read in variables of interest\nacs_age_sex <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X01_AGE_AND_SEX\")\nacs_age_sex_df <- acs_age_sex %>%\n  select(GEOID) %>%\n  mutate(total_pop_from_age_sex = acs_age_sex$B01001e1,\n         median_age = acs_age_sex$B01002e1,\n         pop_male_65_66 = acs_age_sex$B01001e20,\n         pop_male_67_to_69 = acs_age_sex$B01001e21,\n         pop_male_70_to_74 = acs_age_sex$B01001e22,\n         pop_male_75_to_79 = acs_age_sex$B01001e23,\n         pop_male_80_to_84 = acs_age_sex$B01001e24,\n         pop_male_85_and_over = acs_age_sex$B01001e25,\n         pop_female_65_66 = acs_age_sex$B01001e44,\n         pop_female_67_to_69 = acs_age_sex$B01001e45,\n         pop_female_70_to_74 = acs_age_sex$B01001e46,\n         pop_female_75_to_79 = acs_age_sex$B01001e47,\n         pop_female_80_to_84 = acs_age_sex$B01001e48,\n         pop_female_85_and_over = acs_age_sex$B01001e49,\n         pop_65_and_over = pop_male_65_66 + pop_male_67_to_69 + pop_male_70_to_74 + pop_male_75_to_79 + pop_male_80_to_84 + pop_male_85_and_over + pop_female_65_66 + pop_female_67_to_69 + pop_female_70_to_74 + pop_female_75_to_79 + pop_female_80_to_84 + pop_female_85_and_over,\n         pct_65_and_over = (pop_65_and_over / total_pop_from_age_sex) * 100) %>%\n  select(GEOID, total_pop_from_age_sex, pop_65_and_over, pct_65_and_over)\n:::\nRace Layer ::: {.cell}\nacs_race <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X02_RACE\")\n\nReading layer `X02_RACE' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_race_df <- acs_race %>%\n  select(GEOID) %>%\n  mutate(total_pop_from_race = acs_race$B02001e1,\n         pop_white = acs_race$B02001e2,\n         pct_white = (pop_white / total_pop_from_race) * 100,\n         pop_black = acs_race$B02001e3,\n         pct_black = (pop_black / total_pop_from_race) * 100,\n         pop_am_native = acs_race$B02001e4,\n         pct_am_native = (pop_am_native / total_pop_from_race) * 100,\n         pop_asian = acs_race$B02001e5,\n         pct_asian = (pop_asian / total_pop_from_race) * 100)\n:::\nHispanic Latino Layer ::: {.cell}\nacs_hispanic_latino <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X03_HISPANIC_OR_LATINO_ORIGIN\")\n\nReading layer `X03_HISPANIC_OR_LATINO_ORIGIN' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_hispanic_latino_df <- acs_hispanic_latino %>%\n  select(GEOID) %>%\n  mutate(total_pop_from_hispanic = acs_hispanic_latino$B03002e1,\n         pop_hispanic_latino = acs_hispanic_latino$B03002e12,\n         pct_hispanic_latino = (pop_hispanic_latino / total_pop_from_hispanic) * 100)\n\nacs_children_household <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X09_CHILDREN_HOUSEHOLD_RELATIONSHIP\")\n\nReading layer `X09_CHILDREN_HOUSEHOLD_RELATIONSHIP' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_children_household_df <- acs_children_household %>%\n  select(GEOID) %>%\n  mutate(pop_children_under_18 = acs_children_household$B09002e1)\n:::\nPoverty Layer ::: {.cell}\nacs_poverty <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                       layer = \"X17_POVERTY\")\n\nReading layer `X17_POVERTY' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_poverty_df <- acs_poverty %>%\n  select(GEOID) %>%\n  mutate(total_households = acs_poverty$B17017e1,\n         num_households_below_poverty = acs_poverty$B17017e2,\n         pct_households_below_poverty = (num_households_below_poverty / total_households) * 100)\n:::\nIncome Layer ::: {.cell}\nacs_income <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X19_INCOME\")\n\nReading layer `X19_INCOME' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_income_df <- acs_income %>%\n  select(GEOID) %>%\n  mutate(median_income = acs_income$B19013e1,\n         per_capita_income = acs_income$B19301e1)\n:::\nHousing Characteristics Layer ::: {.cell}\nacs_housing_characteristics <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                       layer = \"X25_HOUSING_CHARACTERISTICS\")\n\nReading layer `X25_HOUSING_CHARACTERISTICS' from data source \n  `/Users/marierivers/Documents/Data_Science/blackout_analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb' \n  using driver `OpenFileGDB'\n\n\nWarning: no simple feature geometries present: returning a data.frame or tbl_df\n\nacs_housing_characteristics_df <- acs_housing_characteristics %>%\n  select(GEOID) %>%\n  mutate(num_housing_units = acs_housing_characteristics$B25001e1,\n         median_year_house_built = acs_housing_characteristics$B25035e1,\n         median_year_house_built = na_if(median_year_house_built, 0),\n         num_houses_heated_by_utility_gas = acs_housing_characteristics$B25040e2,\n         num_houses_heated_by_tank_lp_gas = acs_housing_characteristics$B25040e3,\n         num_houses_heated_by_electricity = acs_housing_characteristics$B25040e4,\n         num_houses_heated_by_fuel_oil_kerosene = acs_housing_characteristics$B25040e5,\n         num_houses_heated_by_coal_coke = acs_housing_characteristics$B25040e6,\n         num_houses_heated_by_wood = acs_housing_characteristics$B25040e7,\n         num_houses_heated_by_solar = acs_housing_characteristics$B25040e8,\n         num_houses_heated_by_other_fuel = acs_housing_characteristics$B25040e9,\n         num_houses_heated_by_no_fuel = acs_housing_characteristics$B25040e10,\n         num_houses_not_heated_by_electricity = (num_houses_heated_by_utility_gas + num_houses_heated_by_tank_lp_gas + num_houses_heated_by_fuel_oil_kerosene + num_houses_heated_by_coal_coke + num_houses_heated_by_wood + num_houses_heated_by_solar + num_houses_heated_by_other_fuel + num_houses_heated_by_no_fuel),\n         pct_houses_not_heated_by_electricity = (num_houses_not_heated_by_electricity / num_housing_units) * 100,\n         pct_houses_heated_by_electricity = (num_houses_heated_by_electricity / num_housing_units) * 100,\n         num_houses_owner_occupied_no_vehicle_available = acs_housing_characteristics$B25044e3,\n         num_houses_renter_occupied_no_vehicle_available = acs_housing_characteristics$B25044e10,\n         num_houses_no_vehicle_available = (num_houses_owner_occupied_no_vehicle_available + num_houses_renter_occupied_no_vehicle_available),\n         pct_houses_no_vehicle_available = (num_houses_no_vehicle_available / num_housing_units) * 100) %>%\n  select(GEOID, num_housing_units, median_year_house_built, num_houses_heated_by_electricity, num_houses_not_heated_by_electricity, pct_houses_not_heated_by_electricity, pct_houses_heated_by_electricity, num_houses_no_vehicle_available, pct_houses_no_vehicle_available)\n# xxx...if you have gas heat and lose electricitym do you still have heat?\n::: xxx…normalize these stats by the total population in the tract\nMerge income data to census track data ::: {.cell}\ncensus_tract_data <- acs_geoms %>%\n  left_join(acs_age_sex_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_race_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_hispanic_latino_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_children_household_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_poverty_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_income_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  left_join(acs_housing_characteristics_df, by = c(\"GEOID_Data\" = \"GEOID\")) %>%\n  rename(total_population = total_pop_from_age_sex) %>%\n  select(-c(total_pop_from_race, total_pop_from_hispanic))\n:::\n\ncensus_tract_data_3083 <- st_transform(census_tract_data, 3083)\ncensus_tract_data_4326 <- st_transform(census_tract_data_3083, crs = 4326)\n\ncensus_tract_data_roi_4326 <- st_crop(census_tract_data_4326, roi_sfc)\n\nWarning: attribute variables are assumed to be spatially constant throughout all\ngeometries\n\ncensus_tract_data_roi_3083 <- st_transform(census_tract_data_roi_4326, crs = 3083)\n\n\n\nCode\n# pal_pop <- colorNumeric(\"YlGn\", domain = census_tract_data_4326$total_population)\npal_pop <- colorQuantile(\"Blues\", census_tract_data_roi_4326$total_population, n = 5)\n# pal_pop <- colorBin(\"Blues\", bins = 5, domain = census_tract_data_roi_4326$total_population)\n\npop_colors <- unique(pal_pop(sort(census_tract_data_roi_4326$total_population)))\npop_labs <- format(quantile(census_tract_data_roi_4326$total_population, seq(0, 1, .2)), big.mark = \",\", digits = 0)\npop_labs <- paste(lag(pop_labs), pop_labs, sep = \" - \")[-1]\n\nleaflet(census_tract_data_roi_4326) %>%\n  setView(lat = 29.75, lng = -95.5, zoom = 9) %>%\n  addProviderTiles(providers$OpenStreetMap) %>%\n  addPolygons(fillColor = ~pal_pop(total_population), fillOpacity = 0.75,\n              color = \"gray\", weight = 0.75,\n              label = ~paste(\"Total Population:\", format(total_population, big.mark = \",\")),\n              highlight = highlightOptions(weight = 3, color = \"red\", bringToFront = TRUE)) %>%\n  addLegend(colors = pop_colors, labels = pop_labs,\n            title = \"Total Population\",\n            \"bottomright\")\n\n\n\n\n\n\n\n\nCode\npal_blackout <- colorNumeric(c(\"red\"), 1, na.color = \"transparent\")\n\n#pal_pop <- colorQuantile(\"Blues\", census_tract_data_roi_4326$total_population, n = 5)\npal_pop <- colorBin(\"Blues\", bins = 5, domain = census_tract_data_roi_4326$total_population)\n\ntag.map.title <- tags$style(HTML(\"\n  .leaflet-control.map-title {\n    transform: translate(-50%,20%);\n    position: fixed !important;\n    left: 50%;\n    text-align: center;\n    padding-left: 10px;\n    padding-right: 10px;\n    background: rgba(255,255,255,0.75);\n    color: black;\n    font-weight: bold;\n    font-size: 16px;\n  }\n\"))\n\ntitle <- tags$div(\n  tag.map.title, HTML(\"Census Tract Population and Blackout Areas\")\n)\n\nleaflet(census_tract_data_roi_4326) %>%\n  addProviderTiles(providers$OpenStreetMap) %>%\n  setView(lat = 29.75, lng = -95.5, zoom = 9) %>%\n  addPolygons(fillColor = ~pal_pop(total_population), fillOpacity = 0.75,\n              color = \"gray\", weight = 0.75,\n              label = ~paste(\"Total Population:\", format(total_population, big.mark = \",\")),\n              highlight = highlightOptions(weight = 3, color = \"red\", bringToFront = TRUE),\n              group = \"group_1\") %>%\n  addLegend(pal = pal_pop, values = ~total_population,\n            title = \"Total Population\", position = \"bottomright\",\n            group = \"group_1\") %>%\n  addPolygons(data = blackout_no_highway_4326, fillColor = ~pal_blackout(DNB_At_Sensor_Radiance_500m), fillOpacity = 1, weight = 0,\n              group = \"group_2\") %>%\n  # addLegend(pal = pal_blackout, values = ~blackout_no_highway_4326$DNB_At_Sensor_Radiance_500m,\n  #           title = \"Blackout Areas\", position = \"bottomleft\",\n  #           group = \"group_2\") %>%\n  addControl(title, position = \"topleft\", className=\"map-title\")\n\n\n\n\n\n\n\n# use spatial subsetting to find all the residential buildings in blackout areas (like we did to crop data to our roi)\n\nblackout_buildings_3083 <- buildings_3083[blackout_no_highway_3083, op = st_intersects]\nblackout_buildings_4326 <- st_transform(blackout_buildings_3083, crs = 4326)\n\n# residential houses that did not lose power\nno_blackout_buildings_3083 <- setdiff(buildings_3083, blackout_buildings_3083)\nno_blackout_buildings_4326 <- st_transform(no_blackout_buildings_3083, crs = 4326)\n\n\n# use a spatial join to attach the census tract data to the building data\nblackout_buildings_census_3083 <- st_join(blackout_buildings_3083, census_tract_data_3083) %>%\n  mutate(blackout_status = \"lost power\")\n\nno_blackout_buildings_census_3083 <- st_join(no_blackout_buildings_3083, census_tract_data_3083) %>%\n  mutate(blackout_status = \"did not lose power\")\n\n\n\nCode\nleaflet(blackout_buildings_4326) %>%\n  setView(lat = 29.75, lng = -95.5, zoom = 9) %>%\n  addProviderTiles(providers$OpenStreetMap) %>%\n  addPolygons(label = ~paste(\"Building Type:\", type),\n              highlight = highlightOptions(weight = 2, color = \"black\", bringToFront = TRUE))\n\n\n\n\n\n\n\nnumberofbuildings_without_power <- nrow(blackout_buildings_3083)\n\n\nall_building_data_3083 <- rbind(blackout_buildings_census_3083, no_blackout_buildings_census_3083)\n\n\ncounts_of_lost_power_by_census_tract <- all_building_data_3083 %>%\n  st_drop_geometry() %>%\n  group_by(GEOID_Data, blackout_status) %>%\n  summarise(count = n()) %>%\n  pivot_wider(names_from = blackout_status, values_from = count, values_fill = 0) %>%\n  rename(num_houses_did_not_lose_power = \"did not lose power\",\n         num_houses_lost_power = \"lost power\") %>%\n  mutate(pct_house_that_lost_power = (num_houses_lost_power / (num_houses_did_not_lose_power + num_houses_lost_power)) * 100)\n\n`summarise()` has grouped output by 'GEOID_Data'. You can override using the\n`.groups` argument.\n\n\n\ncensus_tract_blackout_data <- left_join(census_tract_data_roi_4326, counts_of_lost_power_by_census_tract, by = \"GEOID_Data\")\n\n\n# remove spatial info and export to .csv file for use in statistical analysis\ncensus_tract_blackout_data_df <- st_drop_geometry(census_tract_blackout_data) %>% \n  write_csv(\"data/census_tract_blackout_data_df.csv\")"
  },
  {
    "objectID": "index.html#limitations",
    "href": "index.html#limitations",
    "title": "Blackout Analysis",
    "section": "Limitations",
    "text": "Limitations\nThis analysis does not include any verification of power outage locations. This analysis does not incorporate typical variations in night time lights.\nbe clear that correlation is not causation…looking at what groups were more affected than others…what groups were disporportionatly affected\nIn the building data, there are a lot of NA values in the type field. When looking at the data on the map, some non-residential buildings such as schools are included."
  },
  {
    "objectID": "index.html#further-work",
    "href": "index.html#further-work",
    "title": "Blackout Analysis",
    "section": "Further work",
    "text": "Further work\nincorporate utility infrastructure data to identify vulnerable transmission lines"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  },
  {
    "objectID": "census_test.html",
    "href": "census_test.html",
    "title": "census_test",
    "section": "",
    "text": "layers_names <- st_layers(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\")\n\nlayers_names <- layers_names[1]\n\nlayer_names_table <- layers_names %>% \n  kable(ncol = 2) %>% \n  kable_paper()\nlayer_names_table\n\n\n\n  \n    \n\n\n \n  \n    x \n  \n \n\n  \n    X01_AGE_AND_SEX \n  \n  \n    X02_RACE \n  \n  \n    X03_HISPANIC_OR_LATINO_ORIGIN \n  \n  \n    X04_ANCESTRY \n  \n  \n    X05_FOREIGN_BORN_CITIZENSHIP \n  \n  \n    X06_PLACE_OF_BIRTH \n  \n  \n    X07_MIGRATION \n  \n  \n    X08_COMMUTING \n  \n  \n    X09_CHILDREN_HOUSEHOLD_RELATIONSHIP \n  \n  \n    X10_GRANDPARENTS_GRANDCHILDREN \n  \n  \n    X11_HOUSEHOLD_FAMILY_SUBFAMILIES \n  \n  \n    X12_MARITAL_STATUS_AND_HISTORY \n  \n  \n    X13_FERTILITY \n  \n  \n    X14_SCHOOL_ENROLLMENT \n  \n  \n    X15_EDUCATIONAL_ATTAINMENT \n  \n  \n    X16_LANGUAGE_SPOKEN_AT_HOME \n  \n  \n    X17_POVERTY \n  \n  \n    X18_DISABILITY \n  \n  \n    X19_INCOME \n  \n  \n    X20_EARNINGS \n  \n  \n    X21_VETERAN_STATUS \n  \n  \n    X22_FOOD_STAMPS \n  \n  \n    X23_EMPLOYMENT_STATUS \n  \n  \n    X25_HOUSING_CHARACTERISTICS \n  \n  \n    X27_HEALTH_INSURANCE \n  \n  \n    X28_COMPUTER_AND_INTERNET_USE \n  \n  \n    X29_VOTING_AGE_POPULATION \n  \n  \n    X99_IMPUTATION \n  \n  \n    X24_INDUSTRY_OCCUPATION \n  \n  \n    X26_GROUP_QUARTERS \n  \n  \n    TRACT_METADATA_2019 \n  \n  \n    ACS_2019_5YR_TRACT_48_TEXAS \n  \n\n\n\n \n  \n\n\n\n\n\n\nrows <- length(layers_names$name) / 2\n\n# col1 <- layers_names$name[1:16]\n# col2 <- layers_names$name[17:32]\n\ncol1 <- layers_names$name[1:rows]\ncol2 <- layers_names$name[(rows + 1):(rows * 2)]\n\ntwo_col <- kable(list(col1, col2),\n                 col.names = \"Layer Name\", caption = \"ACS Layers\") %>% \n  kable_paper()\n\ntwo_col\n\n\nACS Layers\n\n  \n    \n\n\n \n  \n    Layer Name \n  \n \n\n  \n    X01_AGE_AND_SEX \n  \n  \n    X02_RACE \n  \n  \n    X03_HISPANIC_OR_LATINO_ORIGIN \n  \n  \n    X04_ANCESTRY \n  \n  \n    X05_FOREIGN_BORN_CITIZENSHIP \n  \n  \n    X06_PLACE_OF_BIRTH \n  \n  \n    X07_MIGRATION \n  \n  \n    X08_COMMUTING \n  \n  \n    X09_CHILDREN_HOUSEHOLD_RELATIONSHIP \n  \n  \n    X10_GRANDPARENTS_GRANDCHILDREN \n  \n  \n    X11_HOUSEHOLD_FAMILY_SUBFAMILIES \n  \n  \n    X12_MARITAL_STATUS_AND_HISTORY \n  \n  \n    X13_FERTILITY \n  \n  \n    X14_SCHOOL_ENROLLMENT \n  \n  \n    X15_EDUCATIONAL_ATTAINMENT \n  \n  \n    X16_LANGUAGE_SPOKEN_AT_HOME \n  \n\n\n\n \n    \n\n\n \n  \n    Layer Name \n  \n \n\n  \n    X17_POVERTY \n  \n  \n    X18_DISABILITY \n  \n  \n    X19_INCOME \n  \n  \n    X20_EARNINGS \n  \n  \n    X21_VETERAN_STATUS \n  \n  \n    X22_FOOD_STAMPS \n  \n  \n    X23_EMPLOYMENT_STATUS \n  \n  \n    X25_HOUSING_CHARACTERISTICS \n  \n  \n    X27_HEALTH_INSURANCE \n  \n  \n    X28_COMPUTER_AND_INTERNET_USE \n  \n  \n    X29_VOTING_AGE_POPULATION \n  \n  \n    X99_IMPUTATION \n  \n  \n    X24_INDUSTRY_OCCUPATION \n  \n  \n    X26_GROUP_QUARTERS \n  \n  \n    TRACT_METADATA_2019 \n  \n  \n    ACS_2019_5YR_TRACT_48_TEXAS"
  }
]